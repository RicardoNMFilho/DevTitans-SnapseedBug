package com.ufam.edu.br.seedexploit;

import androidx.appcompat.app.AppCompatActivity;

import android.content.Context;
import android.content.Intent;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.util.Log;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

import java.io.FileNotFoundException;

public class MainActivity extends AppCompatActivity
{

    // Define the pic id
    private static final int pic_id = 123;
    final int ACTIVITY_SELECT_IMAGE = 1234;

    // Define the button and imageview type variable
    Button camera_open_id;
    Button save_gallery;
    ImageView click_image_id;
    TextView gallery;
    Bitmap photo;

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Log.d("Wow", "ENTROU NO onCreate:  " );

        // By ID we can get each component which id is assigned in XML file get Buttons and imageview.
        camera_open_id = findViewById(R.id.camera_button);
        click_image_id = findViewById(R.id.click_image);
        save_gallery = findViewById(R.id.camera_button2);
        gallery = findViewById(R.id.textView);

        // Camera_open button is for open the camera and add the setOnClickListener in this button
        camera_open_id.setOnClickListener(v -> {
            // Create the camera_intent ACTION_IMAGE_CAPTURE it will open the camera for capture the image
            Intent camera_intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
            // Start the activity with camera_intent, and request pic id
            startActivityForResult(camera_intent, pic_id);
        });

        save_gallery.setOnClickListener( v -> {
            Intent intent = new Intent("android.intent.action.SEND", MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
            intent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
            intent.setClassName("com.niksoftware.snapseed", "com.google.android.apps.snapseed.activities.edit.MainActivity");
            intent.putExtra("android.intent.extra.STREAM", "wow");

            startActivityForResult(intent, 0);
        });

        gallery.setOnClickListener( v -> {
            Intent i = new Intent(Intent.ACTION_PICK,
                    android.provider.MediaStore.Images.Media.INTERNAL_CONTENT_URI);

            startActivityForResult(i, ACTIVITY_SELECT_IMAGE);
        });

    }

    protected void onActivityResult(int requestCode, int resultCode, Intent data)
    {
        super.onActivityResult(requestCode, resultCode, data);
        Log.d("Wow", "Entrou no onActivityResult() depois do metodo super.() *** ");
        Log.d("Wow", "**request code value:  " + requestCode );
        Log.d("Wow", "**Data: " + data.getData() + " \t Data extras " +data.getExtras());
        Log.d("Wow", "**Flags: " + data.getFlags());

        // BitMap is data structure of image file which store the image in memory
        if(requestCode == pic_id)
        {
            photo = (Bitmap) data.getExtras().get("data");
            // Set the image in imageview for display
            click_image_id.setImageBitmap(photo);

        }

        if(requestCode == 0)  {
            String uri = MediaStore.Images.Media.insertImage(getContentResolver(),
                    photo,
                    "dev_titans_pic",
                    "Description_123");
        }



    }

}